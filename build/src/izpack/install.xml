<?xml version="1.0" encoding="UTF-8"?>
<installation version="1.0">

  <info>
    <appname>${app.title}</appname>
    <appsubpath>${app.subpath}</appsubpath>
    <appversion>${app.version}</appversion>
    <uninstaller write="no" />
    <javaversion>1.6</javaversion>
    <run-privileged/>
  </info>

  <guiprefs resizable="no" width="640" height="480">
    <laf name="looks">
      <param name="variant" value="windows" />
      <os family="windows" />
    </laf>
  </guiprefs>

  <locale>
    <langpack iso3="eng" />
  </locale>

  <dynamicvariables>
    <variable name="rsna.root" value="$INSTALL_PATH" />
    <variable name="torquebox.version" value="${torquebox.version}" />
    <variable name="openam.version" value="${openam.version}" />
  </dynamicvariables>

  <resources>
    <res id="userInputSpec.xml" src="${basedir}/src/izpack/userInputSpec.xml" />
    <res id="ProcessPanel.Spec.xml" src="${basedir}/src/izpack/ProcessPanel.Spec.xml" />
  </resources>

  <conditions>
    <condition type="variable" id="upgradeinstall">
      <name>upgrade</name>
      <value>1</value>
    </condition>
  </conditions>

  <panels>
    <panel classname="HelloPanel"/>
    <panel classname="UserInputPanel" id="UserInputPanel.0" />
    <panel classname="TargetPanel" />
    <panel classname="PacksPanel" />
    <panel classname="UserInputPanel" id="UserInputPanel.1" />
    <panel classname="UserInputPanel" id="UserInputPanel.2" />
    <panel classname="UserInputPanel" id="UserInputPanel.3" />
    <panel classname="UserInputPanel" id="UserInputPanel.4" />
    <panel classname="UserInputPanel" id="UserInputPanel.5" />
    <panel classname="UserInputPanel" id="UserInputPanel.6" />
    <panel classname="SummaryPanel" />
    <panel classname="InstallPanel" />
    <panel classname="ProcessPanel" />
    <panel classname="SimpleFinishPanel" />
  </panels>

  <packs>
    <pack name="Edgeserver" required="yes">
      <description>Edgeserver Installation</description>
      <fileset dir="token-app" targetdir="$INSTALL_PATH" />
      <fileset dir="ext" targetdir="$INSTALL_PATH/ext" />
      <fileset dir="." targetdir="$INSTALL_PATH">
	<include name="*.jar" />
	<exclude name="izpack*.jar" />
      </fileset>
      <fileset dir="${basedir}/../database" targetdir="$INSTALL_PATH">
	<include name="RSNADB*rollout*.sql" />
      </fileset>
      <file src="version.txt" targetdir="$INSTALL_PATH"/>
      <file src="${basedir}/src/izpack/rsna.conf" targetdir="/etc" />
      <file src="${basedir}/../database/rsna.sql" targetdir="$INSTALL_PATH" />
      <file src="${basedir}/../hl7-receiver-app/Mirth Backup.xml" targetdir="$INSTALL_PATH" />
      <file src="${basedir}/src/izpack/edge-db-install.sh" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/keygen.sh" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/database.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/../receive-content-app/RSNA/config/retrieve-content.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/jvm-opts" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/truststore.jks" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/prep-log4j.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/transfer-log4j.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/token-log4j.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/retrieve-log4j.properties" targetdir="$INSTALL_PATH/conf" />
      <file src="${basedir}/src/izpack/edge-server.conf" targetdir="/etc/init" os="unix" />
      <file src="${basedir}/src/izpack/edge-server" targetdir="/etc/init.d" os="unix" />
      <file src="${basedir}/src/izpack/download-prep.sh" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/version-cleanup.sh" targetdir="$INSTALL_PATH/scripts" />
      <executable targetfile="$INSTALL_PATH/scripts/edge-db-install.sh" stage="never" />
      <executable targetfile="$INSTALL_PATH/scripts/keygen.sh" stage="never" os="unix" />
      <executable targetfile="/etc/init.d/edge-server" stage="never" os="unix" />
      <executable targetfile="$INSTALL_PATH/scripts/download-prep.sh" stage="never" os="unix" />
      <executable targetfile="$INSTALL_PATH/scripts/version-cleanup.sh" stage="never" os="unix" />
      <parsable targetfile="/etc/init/edge-server.conf" type="shell" os="unix" />
      <parsable targetfile="/etc/init.d/edge-server" type="shell" os="unix" />
      <parsable targetfile="$INSTALL_PATH/conf/database.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/conf/retrieve-content.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/conf/prep-log4j.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/conf/transfer-log4j.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/conf/retrieve-log4j.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/conf/token-log4j.properties" type="javaprop" />
      <parsable targetfile="/etc/rsna.conf" os="unix" />
    </pack>
    <pack name="TorqueBox" required="yes">
      <description>TorqueBox Installation</description>
      <file unpack="true" src="torquebox-${torquebox.version}.zip" targetdir="$INSTALL_PATH" />
      <file unpack="true" src="openam-distribution-ssoadmintools-${openam.version}.zip" targetdir="$INSTALL_PATH/ssoadm" />
      <file unpack="true" src="openam-jboss-agent-${openam.agent-version}.zip" targetdir="$INSTALL_PATH" />
      <file src="${basedir}/src/izpack/torquebox-setup.sh" targetdir="$INSTALL_PATH/scripts" />
      <file src="openam-server-${openam.version}.war" targetdir="$INSTALL_PATH" />
      <file src="openam-configurator-tool-${openam.version}.jar" targetdir="$INSTALL_PATH" />
      <file src="${basedir}/src/izpack/jboss-deployment-structure.xml" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/jboss-deploy-agent.xml" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/openam.config" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/agent-res.txt" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/agent-module.xml" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/bootstrap.properties" targetdir="$INSTALL_PATH/scripts" />
      <executable targetfile="$INSTALL_PATH/scripts/torquebox-setup.sh" stage="never" />
      <parsable targetfile="$INSTALL_PATH/scripts/torquebox-setup.sh" type="shell" />
      <parsable targetfile="$INSTALL_PATH/scripts/bootstrap.properties" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/scripts/openam.config" type="javaprop" />
      <parsable targetfile="$INSTALL_PATH/scripts/agent-res.txt" type="javaprop" />
    </pack>
    <pack name="Mirth" required="no" condition="!upgradeinstall">
      <description>Mirth Installation</description>
      <file unpack="true" src="mirth-1.8.2.4472.zip" targetdir="$INSTALL_PATH/mirth" />
      <file src="${basedir}/src/izpack/mirth-setup.sh" targetdir="$INSTALL_PATH/scripts" />
      <file src="${basedir}/src/izpack/wrapper.conf" targetdir="$INSTALL_PATH/mirth/conf" override="true" />
      <executable targetfile="$INSTALL_PATH/scripts/mirth-setup.sh" stage="never" />
      <executable targetfile="$INSTALL_PATH/mirth/mirth-daemon" stage="never" />
      <executable targetfile="$INSTALL_PATH/mirth/mirth.sh" stage="never" />
      <executable targetfile="$INSTALL_PATH/mirth/shell.sh" stage="never" />
      <executable targetfile="$INSTALL_PATH/mirth/wrapper-linux-x86-32" stage="never" />
      <executable targetfile="$INSTALL_PATH/mirth/wrapper-linux-x86-64" stage="never" />
    </pack>
    <pack name="Utilization Reporting" required="no">
      <description>Utilization Reporting</description>
      <fileset dir="." targetdir="$INSTALL_PATH">
	<include name="utilization-report-*.jar" />
      </fileset>
      <file src="${basedir}/src/izpack/edge-cron" targetdir="/etc/cron.d" />
      <file src="${basedir}/src/izpack/utilization-config.sh" targetdir="$INSTALL_PATH/scripts" />
      <parsable targetfile="/etc/cron.d/edge-cron" type="shell" />
      <executable targetfile="$INSTALL_PATH/scripts/utilization-config.sh" stage="never" />
    </pack>
    <pack name="Generate Client Certificate" required="no" condition="!upgradeinstall">
      <description>Generate Client Certificate</description>
    </pack>
    <pack name="download-prep" required="no">
      <description>Prepare Client Downloads</description>
    </pack>
    <pack name="version-cleanup" required="no" condition="upgradeinstall">
      <description>Cleanup Previous Module Versions</description>
    </pack>
</packs>

</installation>
